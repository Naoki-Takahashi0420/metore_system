# サブスクリプション管理完全ガイド

## サブスクリプションとは

サブスクリプション（サブスク）は、月額料金制の契約プランです。
顧客は毎月定額を支払い、月間利用回数内で何度でも施術を受けられます。

### サブスクのメリット
- **顧客側**: 1回あたりの料金が安くなる、通いやすい
- **店舗側**: 安定した月額収入、顧客のリピート率向上

---

## サブスクリプションプラン管理

### プラン一覧の確認
1. サイドバー「サブスク管理」→「サブスクプラン」をクリック
2. 登録されているプランの一覧が表示されます
3. プラン名、月額料金、契約期間、利用回数などが確認できます

### 新しいプランの作成
1. サブスクプラン画面で右上の「新規作成」ボタン
2. 以下の項目を入力：
   - **店舗**: プランを提供する店舗
   - **プラン名**: わかりやすい名称（例：月4回コース、通い放題プラン）
   - **説明**: プランの詳細説明
   - **月額料金**: 毎月の支払額
   - **契約期間**: 何ヶ月契約か（例：12ヶ月、6ヶ月）
   - **月間利用回数**: 月に何回まで利用可能か
   - **対象メニュー**: このプランで利用できるメニューを選択
   - **有効/無効**: ONにすると新規契約可能
3. 「作成」ボタンをクリック

### プランの編集
1. プラン一覧で編集したいプランの行をクリック
2. 「編集」ボタンをクリック
3. 内容を修正して「保存」

**⚠️ 注意**: 既存契約中の顧客には変更は適用されません

### プランの削除
- 既に契約している顧客がいる場合は削除できません
- 「無効化」することで新規契約を停止できます

---

## 顧客のサブスク契約管理

### 契約一覧の確認
1. サイドバー「サブスク管理」→「顧客サブスク」をクリック
2. 全顧客の契約状況が一覧表示されます
3. フィルター機能で以下の条件で絞り込み可能：
   - 店舗
   - 契約状態（有効/期限切れ/キャンセル）
   - プラン
   - 顧客名

### 新規契約の登録
1. 顧客サブスク画面で右上の「新規作成」ボタン
2. 以下の項目を入力：
   - **顧客**: 検索して選択
   - **サブスクプラン**: 契約するプランを選択
   - **開始日**: 契約開始日
   - **終了日**: 契約終了日（自動計算されます）
   - **月間利用回数**: プランのデフォルト値が自動入力
   - **決済方法**: クレジットカード/銀行振込など
   - **ステータス**: 通常は「有効」
3. 「作成」ボタンをクリック

### 契約の確認・編集
1. 契約一覧で対象の契約をクリック
2. 以下の情報が確認できます：
   - 契約プラン詳細
   - 今月の利用回数/残回数
   - 次回決済日
   - 契約期間
   - 決済履歴
3. 「編集」ボタンで内容を変更可能

### 利用回数のリセット
- 毎月1日に自動的に利用回数がリセットされます
- 繰越はありません（使い切らなかった回数は消滅）

### 契約の一時停止
1. 契約の編集画面を開く
2. ステータスを「一時停止」に変更
3. 「保存」ボタンをクリック

**💡 ポイント**: 一時停止中は予約できなくなります

### 契約の解約
1. 契約の編集画面を開く
2. ステータスを「キャンセル」に変更
3. 解約理由を入力（任意）
4. 「保存」ボタンをクリック

**⚠️ 注意**:
- 解約後は予約できなくなります
- 残りの回数も無効になります
- 返金処理は別途手動で行う必要があります

---

## サブスク予約の作成

### タイムラインから予約
1. ダッシュボードの「予約タイムライン」を開く
2. 空き時間をクリック
3. サブスク契約がある顧客を選択
4. メニュー選択時に「サブスクメニュー」を選択
5. 自動的に利用回数が1回消費されます
6. 「予約を作成」ボタンをクリック

### 予約管理画面から予約
1. サイドバー「予約管理」→「新規作成」
2. サブスク契約がある顧客を選択
3. メニュー選択時に、サブスク対象メニューにはアイコンが表示されます
4. サブスクメニューを選択すると、料金が0円になります
5. 予約を作成

**💡 ポイント**:
- サブスク予約は料金が0円になります
- 利用回数を超えると予約できなくなります
- 通常料金での予約も可能です（別途支払い）

---

## 決済管理

### 自動決済設定
1. サブスクプラン作成時に決済方法を設定
2. クレジットカード決済の場合は自動引き落とし
3. 銀行振込の場合は手動確認が必要

### 決済失敗時の対応
1. サイドバー「サブスク管理」→「顧客サブスク」
2. フィルターで「決済失敗」を選択
3. 該当の契約をクリック
4. 顧客に連絡して決済方法を確認
5. 決済完了後、ステータスを「有効」に戻す

### 決済履歴の確認
1. 契約の詳細画面を開く
2. 「決済履歴」タブをクリック
3. 過去の決済状況が一覧表示されます

---

## レポート・分析

### サブスク収益の確認
1. ダッシュボードの「サブスク統計」ウィジェットを確認
2. 以下の指標が表示されます：
   - 有効契約数
   - 月間収益
   - 解約率
   - 平均利用回数

### 人気プランの分析
1. サブスクプラン一覧で契約数を確認
2. 契約数が多いプランが人気プラン
3. 解約率が高いプランは見直しを検討

---

## よくある質問

**Q: サブスク契約中の顧客が通常料金で予約したい**
A: 可能です。予約作成時に通常メニューを選択すれば、サブスク回数を消費せず別料金で予約できます。

**Q: 利用回数を月の途中で変更できますか？**
A: 契約の編集画面で「月間利用回数」を変更できます。翌月から適用されます。

**Q: 契約期間の延長はできますか？**
A: 契約の終了日を編集することで延長できます。

**Q: サブスク予約をキャンセルしたら回数は戻りますか？**
A: はい、予約をキャンセルすると利用回数が復元されます。

**Q: 複数のサブスクプランを契約できますか？**
A: はい、同じ顧客が複数のプランを同時契約できます。予約時にどのプランで予約するか選択できます。

**Q: サブスク契約の途中でプラン変更できますか？**
A: 現在の契約を解約して新しいプランで契約し直す必要があります。

**Q: 決済日を変更できますか？**
A: 契約の「次回決済日」を編集することで変更可能です。

**Q: 利用回数が0になったらどうなりますか？**
A: その月はサブスク予約ができなくなります。翌月1日にリセットされて再び予約可能になります。
